import{j as n}from"./jsx-runtime-D_zvdyIk.js";import{r as i}from"./index-CDlOlYQx.js";import{c as pe}from"./index-K5-zvULe.js";import{u as L}from"./useLatestValue-DL0UuayD.js";import{t as fe}from"./helpers-f26tJ_7u.js";import{X as me}from"./index-vTu4Yset.js";const ge=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,he="_Container_1qlj6_1",ve="_TagInput_1qlj6_76",Te="_Tag_1qlj6_76",ye="_TagRemove_1qlj6_134",we="_TagValue_1qlj6_149",_e="_InputContainer_1qlj6_154",xe="_InputWrapper_1qlj6_161",Ie="_InputMeasure_1qlj6_166",be="_Input_1qlj6_154",Ve="_Limit_1qlj6_214",c={Container:he,TagInput:ve,Tag:Te,TagRemove:ye,TagValue:we,InputContainer:_e,InputWrapper:xe,InputMeasure:Ie,Input:be,Limit:Ve},qe=10,K=24,Ce=500,b=g=>{const{defaultValue:G=[],value:S,size:Z="xl",onChange:H,validator:Y,maxTags:w,placeholder:J="",autoFocus:Q=!1,rows:ee=1,delimiters:N=[","," "],disabled:R,id:te}=g,[ae,A]=i.useState(G),E=S??ae,D=S!==void 0,r=i.useMemo(()=>new Map(E.map(e=>[e.value,e])),[E]),[p,_]=i.useState(""),[V,q]=i.useState(Q),[o,f]=i.useState(null),[ne,k]=i.useState(new Set),[le,M]=i.useState(0),C=L(Y),h=L(H),s=i.useRef(null),u=i.useRef(null),x=i.useRef(null),z=!w||r.size<w;i.useEffect(()=>{if(!V||!u.current)return;const e=s.current??u.current;if(o===null)e.focus();else{const t=u.current.querySelector(`[data-tag="${o}"]`);t?t.focus():e.focus()}},[V,o,z]);const j=r.size===0?J:void 0;i.useLayoutEffect(()=>{if(u.current&&x.current){const e=u.current.getBoundingClientRect(),t=Array.from(u.current.querySelectorAll("[data-tag]")),a=t.length>0?t[t.length-1].getBoundingClientRect().right:e.left;x.current.textContent=p||j||"";const l=x.current.getBoundingClientRect().width+qe,d=e.right-a-K;if(l<=d)M(d);else{const m=e.right-e.left-K;M(m)}}},[p,j,r]);const I=e=>{var m,T;const t=e.trim();if(!t)return;if(r.has(t)){k(v=>new Set(v).add(t)),setTimeout(()=>k(v=>{const W=new Set(v);return W.delete(t),W}),Ce);return}const a=((m=C.current)==null?void 0:m.call(C,t))??!0,l=new Map(r);l.set(t,{value:t,valid:a});const d=Array.from(l.values());(T=h.current)==null||T.call(h,d),D||A(d)},B=e=>{var l;const t=new Map(r);t.delete(e);const a=Array.from(t.values());(l=h.current)==null||l.call(h,a),D||A(a),o===e&&f(null)},F=()=>{if(r.size===0)return;const e=Array.from(r.keys());if(o===null)f(e[e.length-1]);else{const t=e.indexOf(o),a=Math.max(0,t-1);f(e[a])}},re=()=>{if(o===null)return;const e=Array.from(r.keys()),a=e.indexOf(o)+1;a<e.length?f(e[a]):f(null)},P=()=>{const e=s.current;return e?e.selectionStart===0&&e.selectionEnd===0:!0},O=()=>{q(!1),f(null),p&&(I(p),_(""))},se=e=>{e.key==="ArrowLeft"||e.key==="ArrowUp"?P()&&(e.preventDefault(),F()):e.key==="ArrowRight"||e.key==="ArrowDown"?o!==null&&(e.preventDefault(),re()):e.key==="Backspace"&&(o!==null?B(o):P()&&F())},ie=e=>{e.key==="Enter"||N.includes(e.key)?(e.preventDefault(),p&&(I(p),_(""))):e.key==="Tab"&&p&&(e.preventDefault(),I(p),_(""))},oe=e=>{let a=[e.clipboardData.getData("Text")];for(const l of N){const d=[];for(const m of a)d.push(...m.split(l));a=d}a=a.filter(Boolean),a.length>1&&(e.preventDefault(),a.forEach(l=>I(l)))},ue=e=>{if(q(!0),!(e.target&&e.target instanceof Element&&e.target.closest("[data-tag]"))&&(f(null),e.target&&e.target instanceof Element&&s.current&&!s.current.contains(e.target))){e.preventDefault();const{left:t,right:a,top:l,bottom:d}=s.current.getBoundingClientRect(),{clientX:m,clientY:T}=e;if(e.detail===1){if(T<l||m<t)s.current.setSelectionRange(0,0);else if(T>d||m>a){const v=s.current.value.length;s.current.setSelectionRange(v,v)}}else s.current.select()}},de=e=>{e.target&&e.target instanceof Element&&e.target.closest("[data-tag]")||q(!0)},ce=e=>{if(!(!e.relatedTarget||!(e.relatedTarget instanceof Node))){if(u.current&&u.current.contains(e.relatedTarget)){s.current&&s.current.contains(e.relatedTarget)&&f(null);return}O()}};return pe(u,O),n.jsxs(n.Fragment,{children:[n.jsx("div",{className:c.Container,ref:u,onKeyDown:se,onMouseDown:ue,onFocus:de,onBlur:ce,"data-size":Z,"data-focused":V?"":void 0,"data-empty":r.size===0?"":void 0,tabIndex:-1,style:fe({"min-rows":String(ee)}),"data-disabled":R?"":void 0,children:n.jsxs("div",{className:c.TagInput,children:[Array.from(r.values()).map(e=>n.jsxs("div",{className:c.Tag,tabIndex:-1,onClick:()=>f(e.value),"data-tag":e.value,"data-invalid":e.valid?void 0:"","data-duplicate":ne.has(e.value)?"":void 0,children:[n.jsx("span",{className:"overflow-hidden text-ellipsis",title:e.value,children:n.jsx("span",{className:c.TagValue,children:e.value})}),n.jsx("div",{className:c.TagRemove,onClick:()=>B(e.value),role:"button","aria-label":"Remove item",children:n.jsx(me,{height:14,width:14})})]},e.value)),z&&n.jsxs("div",{className:c.InputContainer,children:[n.jsx("span",{ref:x,className:c.InputMeasure}),n.jsx("div",{className:c.InputWrapper,children:n.jsx("input",{id:te,className:c.Input,ref:s,value:p,onChange:e=>{_(e.target.value)},onPaste:oe,onKeyDown:ie,placeholder:j,style:{width:le},disabled:R})})]})]})}),w&&n.jsxs("div",{className:c.Limit,children:[r.size,n.jsx("span",{className:"mx-px",children:"/"}),w]})]})};try{b.displayName="TagInput",b.__docgenInfo={description:"",displayName:"TagInput",props:{defaultValue:{defaultValue:null,description:"The state of the tag input when it is initially rendered, used when uncontrolled",name:"defaultValue",required:!1,type:{name:"Tag[]"}},value:{defaultValue:null,description:"The value of the tag input, used to control the tag input",name:"value",required:!1,type:{name:"Tag[]"}},id:{defaultValue:null,description:"Allows the tag input to be targeted with htmlFor",name:"id",required:!1,type:{name:"string"}},size:{defaultValue:{value:"xl"},description:"Corresponds with Input height when rows=1",name:"size",required:!1,type:{name:"enum",value:[{value:'"md"'},{value:'"lg"'},{value:'"xl"'},{value:'"2xl"'},{value:'"3xl"'}]}},onChange:{defaultValue:null,description:"Callback function invoked when the tag list changes",name:"onChange",required:!1,type:{name:"((tags: Tag[]) => void)"}},placeholder:{defaultValue:null,description:"Placeholder text for the input",name:"placeholder",required:!1,type:{name:"string"}},validator:{defaultValue:null,description:`A function that returns whether a given value is a valid tag.
Invalid tags are highlighted in red.
Tags are evaluated for validity only on creation; changing the validator function later has no effect`,name:"validator",required:!1,type:{name:"((value: string) => boolean)"}},maxTags:{defaultValue:null,description:"The maximum number of tags allowed before the input is disabled; displays a counter below the input",name:"maxTags",required:!1,type:{name:"number"}},autoFocus:{defaultValue:{value:"false"},description:"Whether to focus this input on mount",name:"autoFocus",required:!1,type:{name:"boolean"}},rows:{defaultValue:{value:"1"},description:"The minimum number of rows for the tag input",name:"rows",required:!1,type:{name:"number"}},delimiters:{defaultValue:{value:'[",", " "]'},description:"Controls what characters will count towards creating a new tag",name:"delimiters",required:!1,type:{name:"string[]"}},disabled:{defaultValue:null,description:"Disables the tag input visually and from interactions",name:"disabled",required:!1,type:{name:"boolean"}}}}}catch{}try{TagInput.displayName="TagInput",TagInput.__docgenInfo={description:"",displayName:"TagInput",props:{defaultValue:{defaultValue:null,description:"The state of the tag input when it is initially rendered, used when uncontrolled",name:"defaultValue",required:!1,type:{name:"Tag[]"}},value:{defaultValue:null,description:"The value of the tag input, used to control the tag input",name:"value",required:!1,type:{name:"Tag[]"}},id:{defaultValue:null,description:"Allows the tag input to be targeted with htmlFor",name:"id",required:!1,type:{name:"string"}},size:{defaultValue:{value:"xl"},description:"Corresponds with Input height when rows=1",name:"size",required:!1,type:{name:"enum",value:[{value:'"md"'},{value:'"lg"'},{value:'"xl"'},{value:'"2xl"'},{value:'"3xl"'}]}},onChange:{defaultValue:null,description:"Callback function invoked when the tag list changes",name:"onChange",required:!1,type:{name:"((tags: Tag[]) => void)"}},placeholder:{defaultValue:null,description:"Placeholder text for the input",name:"placeholder",required:!1,type:{name:"string"}},validator:{defaultValue:null,description:`A function that returns whether a given value is a valid tag.
Invalid tags are highlighted in red.
Tags are evaluated for validity only on creation; changing the validator function later has no effect`,name:"validator",required:!1,type:{name:"((value: string) => boolean)"}},maxTags:{defaultValue:null,description:"The maximum number of tags allowed before the input is disabled; displays a counter below the input",name:"maxTags",required:!1,type:{name:"number"}},autoFocus:{defaultValue:{value:"false"},description:"Whether to focus this input on mount",name:"autoFocus",required:!1,type:{name:"boolean"}},rows:{defaultValue:{value:"1"},description:"The minimum number of rows for the tag input",name:"rows",required:!1,type:{name:"number"}},delimiters:{defaultValue:{value:'[",", " "]'},description:"Controls what characters will count towards creating a new tag",name:"delimiters",required:!1,type:{name:"string[]"}},disabled:{defaultValue:null,description:"Disables the tag input visually and from interactions",name:"disabled",required:!1,type:{name:"boolean"}}}}}catch{}const je={title:"Components/TagInput",component:b,args:{placeholder:"example@openai.com",validator:g=>ge.test(g),rows:3,autoFocus:!0}},y=g=>n.jsx("div",{style:{width:350},children:n.jsx(b,{...g})});var X,U,$;y.parameters={...y.parameters,docs:{...(X=y.parameters)==null?void 0:X.docs,source:{originalSource:`(args: TagInputProps) => <div style={{
  width: 350
}}>
    <TagInput {...args} />
  </div>`,...($=(U=y.parameters)==null?void 0:U.docs)==null?void 0:$.source}}};const Se=["Base"],Me=Object.freeze(Object.defineProperty({__proto__:null,Base:y,__namedExportsOrder:Se,default:je},Symbol.toStringTag,{value:"Module"}));export{y as B,Me as T};
