import{j as x}from"./jsx-runtime-D_zvdyIk.js";import{c as j}from"./clsx-B-dksMZM.js";import{r as l}from"./index-CDlOlYQx.js";import{b as D}from"./index-K5-zvULe.js";import{u as H}from"./useEscCloseStack-D1Z2m5Rr.js";import{u as R}from"./useLatestValue-DL0UuayD.js";import{p as q,t as M,f as L}from"./helpers-f26tJ_7u.js";import{T as S}from"./index-DZdtDvV8.js";import{R as I,T as F,P as G,C as K}from"./index-DvP4gEHi.js";import"./index-BGZCjPBa.js";const B=(t,r)=>{const e=t.currentTarget,n={x:t.clientX,y:t.clientY},o=$(n,e.getBoundingClientRect()),u=z(n,o),i=X(r.getBoundingClientRect());return J([...u,...i])};function $(t,r){const e=Math.abs(r.top-t.y),n=Math.abs(r.bottom-t.y),o=Math.abs(r.right-t.x),u=Math.abs(r.left-t.x);switch(Math.min(e,n,o,u)){case u:return"left";case o:return"right";case e:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function z(t,r,e=5){const n=[];switch(r){case"top":n.push({x:t.x-e,y:t.y+e},{x:t.x+e,y:t.y+e});break;case"bottom":n.push({x:t.x-e,y:t.y-e},{x:t.x+e,y:t.y-e});break;case"left":n.push({x:t.x+e,y:t.y-e},{x:t.x+e,y:t.y+e});break;case"right":n.push({x:t.x-e,y:t.y-e},{x:t.x-e,y:t.y+e});break}return n}function X(t){const{top:r,right:e,bottom:n,left:o}=t;return[{x:o,y:r},{x:e,y:r},{x:e,y:n},{x:o,y:n}]}function Y(t,r){const{x:e,y:n}=t;let o=!1;for(let u=0,i=r.length-1;u<r.length;i=u++){const h=r[u],f=r[i],y=h.x,c=h.y,a=f.x,s=f.y;c>n!=s>n&&e<(a-y)*(n-c)/(s-c)+y&&(o=!o)}return o}function J(t){const r=t.slice();return r.sort((e,n)=>e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0),Q(r)}function Q(t){if(t.length<=1)return t.slice();const r=[];for(let n=0;n<t.length;n++){const o=t[n];for(;r.length>=2;){const u=r[r.length-1],i=r[r.length-2];if((u.x-i.x)*(o.y-i.y)>=(u.y-i.y)*(o.x-i.x))r.pop();else break}r.push(o)}r.pop();const e=[];for(let n=t.length-1;n>=0;n--){const o=t[n];for(;e.length>=2;){const u=e[e.length-1],i=e[e.length-2];if((u.x-i.x)*(o.y-i.y)>=(u.y-i.y)*(o.x-i.x))e.pop();else break}e.push(o)}return e.pop(),r.length===1&&e.length===1&&r[0].x===e[0].x&&r[0].y===e[0].y?r:r.concat(e)}const U="_Transition_baxzo_1",Z="_Popover_baxzo_5",N={Transition:U,Popover:Z},w=l.createContext(null),P=()=>{const t=l.use(w);if(!t)throw new Error("Popover components must be wrapped in <Popover />");return t};try{w.displayName="PopoverContext",w.__docgenInfo={description:"",displayName:"PopoverContext",props:{}}}catch{}const _=({open:t,onOpenChange:r,showOnHover:e=!1,hoverOpenDelay:n=150,children:o})=>{const[u,i]=l.useState(!1),[h,f]=l.useState(!1),y=l.useRef(null),c=l.useRef(null),a=l.useRef(void 0),s=l.useRef(!1),v=l.useRef(!1),d=t??u,[p,m]=l.useState(!1);D(()=>m(!1),p?500:null);const g=R(r),C=R(T=>{var O,k;clearTimeout(a.current),d!==T&&(T||(f(!1),e&&s.current&&((O=y.current)==null||O.focus()),s.current=!1),(k=g.current)==null||k.call(g,T),i(T),e&&m(T))}),b=l.useCallback(T=>{C.current(T)},[C]),E=l.useCallback(()=>{a.current=setTimeout(()=>b(!0),n)},[b,n]),V=l.useCallback(()=>{clearTimeout(a.current)},[]);l.useEffect(()=>()=>{clearTimeout(a.current)},[]);const W=l.useMemo(()=>({open:d,setOpen:b,shake:h,setShake:f,showOnHover:e,temporarilyPreventClickToClose:p,onTriggerEnter:E,onTriggerLeave:V,isPointerInTransitRef:v,triggerRef:y,contentRef:c,hoverOpenFocusedWithTab:s}),[d,b,h,f,e,p,s,v,E,V]);return x.jsx(w,{value:W,children:x.jsx(I,{open:d,onOpenChange:b,modal:!1,children:o})})},ee=({children:t,onPointerDown:r,onClick:e})=>{const{setOpen:n,showOnHover:o,temporarilyPreventClickToClose:u,onTriggerEnter:i,onTriggerLeave:h,isPointerInTransitRef:f,triggerRef:y,contentRef:c}=P(),a=l.useRef(!1),s=p=>{!(p.currentTarget.nodeName.toLocaleLowerCase()==="a")&&u&&(p.preventDefault(),p.stopPropagation())},v=p=>{p.pointerType!=="touch"&&!a.current&&!f.current&&(i(),a.current=!0)},d=()=>{a.current&&(h(),a.current=!1)};return x.jsx(F,{asChild:!0,ref:y,onPointerDown:p=>{s(p),r==null||r(p)},onClick:p=>{s(p),e==null||e(p)},onPointerMove:o?v:void 0,onPointerLeave:o?d:void 0,onFocus:o?()=>n(!0):void 0,onBlur:o?()=>{setTimeout(()=>{var p;(p=c.current)!=null&&p.contains(document.activeElement)||n(!1)},50)}:void 0,children:t})},A=({children:t,avoidCollisions:r,width:e,minWidth:n,maxWidth:o,side:u,sideOffset:i=8,align:h,alignOffset:f,translucent:y,className:c,autoFocus:a=!0})=>{const{showOnHover:s,shake:v,contentRef:d}=P(),p=m=>{const g=d.current;if(g&&m.target===g&&m.key==="Tab"&&m.shiftKey){m.preventDefault(),m.stopPropagation();const C=L(g),b=C[C.length-1];b==null||b.focus()}};return l.useEffect(()=>{const m=d.current;!m||!a||m!=null&&m.contains(document.activeElement)||s||m.focus({preventScroll:!0})},[d,s,a]),x.jsx(K,{forceMount:!0,ref:d,className:j(N.Popover,c),style:M({"popover-width":e,"popover-min-width":n,"popover-max-width":o}),onCloseAutoFocus:s?q:void 0,"data-animate":v?"shake":void 0,"data-translucent":y?"true":void 0,side:u,sideOffset:i,align:h,alignOffset:f??(h==="center"?0:-5),avoidCollisions:r??!0,hideWhenDetached:!0,collisionPadding:20,onOpenAutoFocus:q,onEscapeKeyDown:q,onKeyDown:p,children:t})},te=t=>{const{setOpen:r,triggerRef:e,contentRef:n,isPointerInTransitRef:o,hoverOpenFocusedWithTab:u}=P(),[i,h]=l.useState(null),f=l.useCallback(()=>{h(null),o.current=!1},[o]),y=l.useCallback((c,a)=>{const s=B(c,a);h(s),o.current=!0},[o]);return l.useEffect(()=>()=>f(),[f]),l.useEffect(()=>{const c=e.current,a=n.current;if(!c||!a)return;const s=d=>y(d,a),v=d=>y(d,c);return c.addEventListener("pointerleave",s),a.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",s),a.removeEventListener("pointerleave",v)}},[n,e,y,f]),l.useEffect(()=>{if(!i)return;const c=a=>{const s=e.current,v=n.current,d=a.target,p={x:a.clientX,y:a.clientY},m=(s==null?void 0:s.contains(d))||(v==null?void 0:v.contains(d)),g=!Y(p,i),C=d.hasAttribute("aria-haspopup");m?f():(g||C)&&(f(),r(!1))};return document.addEventListener("pointermove",c),()=>document.removeEventListener("pointermove",c)},[i,r,f,e,n]),l.useEffect(()=>{const c=a=>{if(n.current&&a.key==="Tab"&&!a.shiftKey){const[s]=L(n.current);s&&(a.preventDefault(),s.focus(),u.current=!0,document.removeEventListener("keydown",c))}};return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[n,u]),x.jsx(A,{...t})},ne=t=>{const{open:r,showOnHover:e,setOpen:n}=P();return H(r,()=>{n(!1)}),x.jsx(G,{forceMount:!0,children:x.jsx(S,{enterDuration:600,exitDuration:300,className:N.Transition,disableAnimations:!0,children:r&&(e?x.jsx(te,{...t},"popover-hover"):x.jsx(A,{...t},"popover"))})})};_.Trigger=ee;_.Content=ne;try{_.displayName="Popover",_.__docgenInfo={description:"",displayName:"Popover",props:{open:{defaultValue:null,description:"Sets controlled visibility state",name:"open",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Callback invoked when visibility state changes",name:"onOpenChange",required:!1,type:{name:"((nextState: boolean) => void)"}},showOnHover:{defaultValue:{value:"false"},description:"",name:"showOnHover",required:!1,type:{name:"boolean"}},hoverOpenDelay:{defaultValue:{value:"150"},description:"",name:"hoverOpenDelay",required:!1,type:{name:"number"}}}}}catch{}try{_.Trigger.displayName="Popover.Trigger",_.Trigger.__docgenInfo={description:"",displayName:"Popover.Trigger",props:{onPointerDown:{defaultValue:null,description:"",name:"onPointerDown",required:!1,type:{name:"PointerEventHandler"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"MouseEventHandler"}}}}}catch{}try{_.Content.displayName="Popover.Content",_.Content.__docgenInfo={description:"",displayName:"Popover.Content",props:{avoidCollisions:{defaultValue:{value:"true"},description:"Whether to avoid collisions with vieport/scroll containersw.",name:"avoidCollisions",required:!1,type:{name:"boolean"}},width:{defaultValue:{value:"auto"},description:"Set the `width` of the popover, in pixels.",name:"width",required:!1,type:{name:'number | "auto"'}},minWidth:{defaultValue:{value:"300"},description:"Set the `min-width` of the popover, in pixels.",name:"minWidth",required:!1,type:{name:'number | "auto"'}},maxWidth:{defaultValue:null,description:"Set the `max-width` of the popover, in pixels.",name:"maxWidth",required:!1,type:{name:"number"}},side:{defaultValue:{value:"bottom"},description:"The preferred side of the trigger to render against when open. Will be reversed when collisions occur.",name:"side",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'}]}},sideOffset:{defaultValue:{value:"8"},description:"The distance in pixels from the trigger.",name:"sideOffset",required:!1,type:{name:"number"}},align:{defaultValue:{value:"center"},description:"The preferred alignment against the trigger. May change when collisions occur.",name:"align",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'}]}},alignOffset:{defaultValue:{value:"0"},description:'An offset in pixels from the "start" or "end" alignment options.',name:"alignOffset",required:!1,type:{name:"number"}},translucent:{defaultValue:{value:"false"},description:"Whether the popover surface should be translucent.",name:"translucent",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"Additional class name to apply to the popover content, you usually don't want to set this, but ag-grid needs it to render a custom editor properly",name:"className",required:!1,type:{name:"string"}},autoFocus:{defaultValue:{value:"true"},description:"Auto focus the popover content when it is opened.",name:"autoFocus",required:!1,type:{name:"boolean"}}}}}catch{}try{Popover.displayName="Popover",Popover.__docgenInfo={description:"",displayName:"Popover",props:{open:{defaultValue:null,description:"Sets controlled visibility state",name:"open",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Callback invoked when visibility state changes",name:"onOpenChange",required:!1,type:{name:"((nextState: boolean) => void)"}},showOnHover:{defaultValue:{value:"false"},description:"",name:"showOnHover",required:!1,type:{name:"boolean"}},hoverOpenDelay:{defaultValue:{value:"150"},description:"",name:"hoverOpenDelay",required:!1,type:{name:"number"}}}}}catch{}try{Popover.Trigger.displayName="Popover.Trigger",Popover.Trigger.__docgenInfo={description:"",displayName:"Popover.Trigger",props:{onPointerDown:{defaultValue:null,description:"",name:"onPointerDown",required:!1,type:{name:"PointerEventHandler"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"MouseEventHandler"}}}}}catch{}try{Popover.Content.displayName="Popover.Content",Popover.Content.__docgenInfo={description:"",displayName:"Popover.Content",props:{avoidCollisions:{defaultValue:{value:"true"},description:"Whether to avoid collisions with vieport/scroll containersw.",name:"avoidCollisions",required:!1,type:{name:"boolean"}},width:{defaultValue:{value:"auto"},description:"Set the `width` of the popover, in pixels.",name:"width",required:!1,type:{name:'number | "auto"'}},minWidth:{defaultValue:{value:"300"},description:"Set the `min-width` of the popover, in pixels.",name:"minWidth",required:!1,type:{name:'number | "auto"'}},maxWidth:{defaultValue:null,description:"Set the `max-width` of the popover, in pixels.",name:"maxWidth",required:!1,type:{name:"number"}},side:{defaultValue:{value:"bottom"},description:"The preferred side of the trigger to render against when open. Will be reversed when collisions occur.",name:"side",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'}]}},sideOffset:{defaultValue:{value:"8"},description:"The distance in pixels from the trigger.",name:"sideOffset",required:!1,type:{name:"number"}},align:{defaultValue:{value:"center"},description:"The preferred alignment against the trigger. May change when collisions occur.",name:"align",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'}]}},alignOffset:{defaultValue:{value:"0"},description:'An offset in pixels from the "start" or "end" alignment options.',name:"alignOffset",required:!1,type:{name:"number"}},translucent:{defaultValue:{value:"false"},description:"Whether the popover surface should be translucent.",name:"translucent",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"Additional class name to apply to the popover content, you usually don't want to set this, but ag-grid needs it to render a custom editor properly",name:"className",required:!1,type:{name:"string"}},autoFocus:{defaultValue:{value:"true"},description:"Auto focus the popover content when it is opened.",name:"autoFocus",required:!1,type:{name:"boolean"}}}}}catch{}export{_ as P,P as u};
