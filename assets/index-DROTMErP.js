import{o as f,l as b,f as k,m as g}from"./Markdown.stories-DpvFqZFi.js";import"./jsx-runtime-D_zvdyIk.js";import"./clsx-B-dksMZM.js";import"./index-CDlOlYQx.js";import"./CodeBlock-BgCMP09Y.js";import"./index-f1W-XCGd.js";import"./index-DSWOpmMK.js";import"./helpers-f26tJ_7u.js";import"./renderHelpers-DMqZrfTK.js";import"./internal-DlOBqL0c.js";import"./AppsSDKUIContext-M1LWlfJD.js";import"./index-D7F-HZ0J.js";import"./index-K5-zvULe.js";import"./index-Bf2qc8Rt.js";import"./copyToClipboard-B2drfy3h.js";import"./index-vTu4Yset.js";import"./TextLink-_vsY4L_3.js";import"./iframe-BD9l1ykc.js";function P(){return{enter:{mathFlow:t,mathFlowFenceMeta:u,mathText:c},exit:{mathFlow:e,mathFlowFence:i,mathFlowFenceMeta:l,mathFlowValue:s,mathText:m,mathTextData:s}};function t(r){const o={type:"element",tagName:"code",properties:{className:["language-math","math-display"]},children:[]};this.enter({type:"math",meta:null,value:"",data:{hName:"pre",hChildren:[o]}},r)}function u(){this.buffer()}function l(){const r=this.resume(),o=this.stack[this.stack.length-1];f(o.type==="math"),o.meta=r}function i(){this.data.mathFlowInside||(this.buffer(),this.data.mathFlowInside=!0)}function e(r){const o=this.resume().replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),h=this.stack[this.stack.length-1];f(h.type==="math"),this.exit(r),h.value=o;const p=h.data.hChildren[0];f(p.type==="element"),f(p.tagName==="code"),p.children.push({type:"text",value:o}),this.data.mathFlowInside=void 0}function c(r){this.enter({type:"inlineMath",value:"",data:{hName:"code",hProperties:{className:["language-math","math-inline"]},hChildren:[]}},r),this.buffer()}function m(r){const o=this.resume(),h=this.stack[this.stack.length-1];f(h.type==="inlineMath"),this.exit(r),h.value=o,h.data.hChildren.push({type:"text",value:o})}function s(r){this.config.enter.data.call(this,r),this.config.exit.data.call(this,r)}}function D(t){let u=(t||{}).singleDollarTextMath;return u==null&&(u=!0),i.peek=e,{unsafe:[{character:"\r",inConstruct:"mathFlowMeta"},{character:`
`,inConstruct:"mathFlowMeta"},{character:"$",after:u?void 0:"\\$",inConstruct:"phrasing"},{character:"$",inConstruct:"mathFlowMeta"},{atBreak:!0,character:"$",after:"\\$"}],handlers:{math:l,inlineMath:i}};function l(c,m,s,r){const o=c.value||"",h=s.createTracker(r),p="$".repeat(Math.max(b(o,"$")+1,2)),w=s.enter("mathFlow");let x=h.move(p);if(c.meta){const F=s.enter("mathFlowMeta");x+=h.move(s.safe(c.meta,{after:`
`,before:x,encode:["$"],...h.current()})),F()}return x+=h.move(`
`),o&&(x+=h.move(o+`
`)),x+=h.move(p),w(),x}function i(c,m,s){let r=c.value||"",o=1;for(u||o++;new RegExp("(^|[^$])"+"\\$".repeat(o)+"([^$]|$)").test(r);)o++;const h="$".repeat(o);/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^\$|\$$/.test(r))&&(r=" "+r+" ");let p=-1;for(;++p<s.unsafe.length;){const w=s.unsafe[p];if(!w.atBreak)continue;const x=s.compilePattern(w);let F;for(;F=x.exec(r);){let a=F.index;r.codePointAt(a)===10&&r.codePointAt(a-1)===13&&a--,r=r.slice(0,a)+" "+r.slice(F.index+1)}}return h+r+h}function e(){return"$"}}const v={tokenize:N,concrete:!0,name:"mathFlow"},z={tokenize:I,partial:!0};function N(t,u,l){const i=this,e=i.events[i.events.length-1],c=e&&e[1].type==="linePrefix"?e[2].sliceSerialize(e[1],!0).length:0;let m=0;return s;function s(n){return t.enter("mathFlow"),t.enter("mathFlowFence"),t.enter("mathFlowFenceSequence"),r(n)}function r(n){return n===36?(t.consume(n),m++,r):m<2?l(n):(t.exit("mathFlowFenceSequence"),k(t,o,"whitespace")(n))}function o(n){return n===null||g(n)?p(n):(t.enter("mathFlowFenceMeta"),t.enter("chunkString",{contentType:"string"}),h(n))}function h(n){return n===null||g(n)?(t.exit("chunkString"),t.exit("mathFlowFenceMeta"),p(n)):n===36?l(n):(t.consume(n),h)}function p(n){return t.exit("mathFlowFence"),i.interrupt?u(n):t.attempt(z,w,M)(n)}function w(n){return t.attempt({tokenize:C,partial:!0},M,x)(n)}function x(n){return(c?k(t,F,"linePrefix",c+1):F)(n)}function F(n){return n===null?M(n):g(n)?t.attempt(z,w,M)(n):(t.enter("mathFlowValue"),a(n))}function a(n){return n===null||g(n)?(t.exit("mathFlowValue"),F(n)):(t.consume(n),a)}function M(n){return t.exit("mathFlow"),u(n)}function C(n,$,y){let T=0;return k(n,S,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4);function S(d){return n.enter("mathFlowFence"),n.enter("mathFlowFenceSequence"),E(d)}function E(d){return d===36?(T++,n.consume(d),E):T<m?y(d):(n.exit("mathFlowFenceSequence"),k(n,q,"whitespace")(d))}function q(d){return d===null||g(d)?(n.exit("mathFlowFence"),$(d)):y(d)}}}function I(t,u,l){const i=this;return e;function e(m){return m===null?u(m):(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),c)}function c(m){return i.parser.lazy[i.now().line]?l(m):u(m)}}function O(t){let l=(t||{}).singleDollarTextMath;return l==null&&(l=!0),{tokenize:i,resolve:L,previous:_,name:"mathText"};function i(e,c,m){let s=0,r,o;return h;function h(a){return e.enter("mathText"),e.enter("mathTextSequence"),p(a)}function p(a){return a===36?(e.consume(a),s++,p):s<2&&!l?m(a):(e.exit("mathTextSequence"),w(a))}function w(a){return a===null?m(a):a===36?(o=e.enter("mathTextSequence"),r=0,F(a)):a===32?(e.enter("space"),e.consume(a),e.exit("space"),w):g(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),w):(e.enter("mathTextData"),x(a))}function x(a){return a===null||a===32||a===36||g(a)?(e.exit("mathTextData"),w(a)):(e.consume(a),x)}function F(a){return a===36?(e.consume(a),r++,F):r===s?(e.exit("mathTextSequence"),e.exit("mathText"),c(a)):(o.type="mathTextData",x(a))}}}function L(t){let u=t.length-4,l=3,i,e;if((t[l][1].type==="lineEnding"||t[l][1].type==="space")&&(t[u][1].type==="lineEnding"||t[u][1].type==="space")){for(i=l;++i<u;)if(t[i][1].type==="mathTextData"){t[u][1].type="mathTextPadding",t[l][1].type="mathTextPadding",l+=2,u-=2;break}}for(i=l-1,u++;++i<=u;)e===void 0?i!==u&&t[i][1].type!=="lineEnding"&&(e=i):(i===u||t[i][1].type==="lineEnding")&&(t[e][1].type="mathTextData",i!==e+2&&(t[e][1].end=t[i-1][1].end,t.splice(e+2,i-e-2),u-=i-e-2,i=e+2),e=void 0);return t}function _(t){return t!==36||this.events[this.events.length-1][1].type==="characterEscape"}function A(t){return{flow:{36:v},text:{36:O(t)}}}const B={};function at(t){const u=this,l=t||B,i=u.data(),e=i.micromarkExtensions||(i.micromarkExtensions=[]),c=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),m=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);e.push(A(l)),c.push(P()),m.push(D(l))}export{at as default};
